Following is how documents are stored in database.

# Holes Collection
```json
{
  "_id": {
    "$oid": "545efe76a98d930012da6d4b"
  },
  "publish_time": "Tue May 31 17:46:55 +0800 2011",
  "text": "Hello Treehole! :smile:",
  "images": [
    {"$pid": "1123hopafsd092asd3"}
  ],
  "user": {
    "$uid": 109823742
  },
  "feedbacks": [
    {"$fid": "0987zvij12321sa"},
    {"$fid": "apoi123209z8ah2"},
    {"$fid": "a9x7jj1gh2kjsj0"}
  ],
  "options": {
    "anonymous": true,
    "channel": 3
  }
}
```
| Field       | Description | Must Exist | Index |
| ----------- | ----------- | ---------- | ----- |
| `_id`       | This field is generated by mongodb. `$oid` is an mono-increase ID which contains info of insertion time. | Default | Default |
| `images`    | Use provided `$pid` you can go to retrieve hosted images. E.g. <http://img.lab.mu/1123hopafsd092asd3?format=png&size=medium>. | No | No |
| `$uid`      | You can use this user ID to lookup detailed info in *Users Collection*. | Yes | Yes |
| `feedbacks` | Use provided `$fid` you can go to retrieve detailed information and statistics of feedback buttons. | No | No |
| `options`   | Contains options about where to publish, visibility etc. If `anonymous` is `true`, the unique role for the author can be found in *Roles Collection*. | Yes | Yes |

# Comments Collection
``` json
{
  "_id": {
    "$oid": "545efe76a98d930012da6d4b"
  },
  "post_time": "Tue May 31 17:56:55 +0800 2011",
  "text": "This is a simple comment",
  "from_user": {
    "$uid": 2147483648
  },
  "to_user": {
    "$uid": 109823742
  },
  "options": {
    "anonymous": true,
    "secret": false
  }
}
```
| Field       | Description |
| ----------- | ----------- |
| `_id`       | This field is generated by mongodb. `$oid` is an mono-increase id which contains info of insertion time. |
| `from_user` | User ID for author of this comment |
| `to_user`   | User ID for recipient of this comment |
| `options`   | Contains options about visibility, secret, etc. |

# Users Collection
```json
{
  "$uid": 109823742,
  "join_time": "Tue May 10 23:46:55 +0800 2011",
  "code_name": "xiao_wang",
  "screen_name": "王霸之气",
  "contact_info": {
    "email": "xiao.wang@163.com",
    "mobile": "112341234432"
  },
  "links": [
    {"url": "http://xiaowang.io", "text": "个人博客"},
    {"url": "http://linkedin.com/xiaowang"}
  ],
  "tsinghua_account": {
    "student_number": "2014311111",
    "student_id": "xiaowang14",
    "real_name": "小王",
    "student_type": "博士",
    "gender": "男",
    "department": "交叉信息研究院",
    "email": "xiao.wang@gmail.com",
    "mobile": "+8612341234432"
  },
  "wechat_account": {
  },
  "renren_account": {
  },
  "weibo_account": {
    "uid": "12341234",
    "expires_in": "1234",
    "access_token": "ACCESS_TOKEN"
  }
}
```

# Roles Collection
```json
{
  "user": {
    "$uid": 109823742
  },
  "hole": {
    "$hid": "545efe76a98d930012da6d4b"
  },
  "avatar": {
    "$pid": "19208asfio102h9x21"
  },
  "text": "楼主"
}
```
| Field       | Description |
| ----------- | ----------- |
| `user`      | The real user behind this role |
| `hole`      | Under which hole the role is available |
| `avatar`    | Reference to a picture to be displayed as an avatar |
| `text`      | Name to distinguish this role from others |

# Feedbacks Collection
```json
{
    "type": "vote",
    "text": "dislike",
    "count": 10
}
```
| Field       | Description |
| ----------- | ----------- |
| `type`      | This field contains an ID corrspond to a specific hole |
| `text`      | Text to be display to user as a button |
| `count`     | Count on user who press this feedback |

# References Collection
```json
{
  "referrer": "545efe76a98d930012da6d4b",
  "reference": "545efe74a98d930013da8c03"
}
```
```json
{
  "referrer": "545efe76a98d930012da6d4b",
  "reference": "545efe74a98d930013da8c02"
}
```
